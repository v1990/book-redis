# 缓存

[TOC]

## 缓存更新策略
### LRU/LFU/FIFO算法删除
### 超时删除
### 主动更新
## 缓存粒度控制

## 缓存穿透
缓存穿透指查询一个根本不存在的数据，请求直接穿透到DB
### 应对策略
1. 缓存空对象，但是过期时间设置短一些
2. 布隆过滤器拦截

## 缓存雪崩
缓存雪崩指缓存服务挂了（crash），所有请求都穿透了

应对策略：
- 保证缓存层服务的高可用；如[redis sentinel](../sentinel)和[redis cluster](../cluster)
- 依赖隔离组件为后端限流并降级
- 提前演练，看后端是否能撑住

## hot key
指某个`key`的请求量非常大，在该key失效的瞬间，造成所有请求都穿透了；

应对策略
- 利用互斥锁(mutex):只允许一个线程重建缓存，其他线程需等待锁释放，然后再从缓存中获取数据
- 永远不过期，让另一个线程主动更新该key
